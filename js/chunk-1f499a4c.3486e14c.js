(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1f499a4c"],{"1b91":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"bg animated fadeIn faster"},[t.dom.login?s("Login"):t._e(),s("loading",{attrs:{active:t.isLoading},on:{"update:active":function(a){t.isLoading=a}}},[s("img",{attrs:{alt:"Meason",src:e("333e"),width:"100"}})]),t.data?s("div",{staticClass:"modal-dialog modal-dialog-centered modal-lg",attrs:{role:"document"}},[s("div",{staticClass:"modal-content"},[s("div",{staticClass:"modal-header"},[s("h3",{staticClass:"modal-title h5"},[t._v(t._s(t.data.title))]),s("router-link",{staticClass:"close",attrs:{to:"/show",tag:"button",type:"button","aria-label":"Close"}},[s("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])],1),s("div",{staticClass:"modal-body"},[s("div",{staticClass:"modal-con"},[s("div",{staticClass:"row m-0"},[s("div",{staticClass:"col-lg-6 mb-3"},[s("div",{staticClass:"pic img-thumbnail",style:{backgroundImage:"url('"+t.data.picURL+"')"}})]),s("div",{staticClass:"col-lg-6 info-con mb-3"},[s("ul",[s("li",[t._m(0),t._v(" "+t._s(t.data.city))]),s("li",[t._m(1),s("p",t._l(t.data.type,function(a){return s("span",{key:a,staticClass:"type"},[t._v(t._s(a))])}),0)]),s("li",[t._m(2),t._v(" "+t._s(t.data.date))])]),s("p",{staticClass:"contact"},[s("span",[t._v("活動期間")]),t._v("\n                "+t._s(t.data.show_date)+"\n              ")])]),s("div",{staticClass:"col-md-12 bio"},[t._m(3),s("div",{staticClass:"tab-content",attrs:{id:"myTabContent"}},[s("div",{staticClass:"tab-pane fade show active",attrs:{id:"band",role:"tabpanel","aria-labelledby":"band-tab"}},[s("pre",{directives:[{name:"linkified",rawName:"v-linkified"}],staticClass:"pre",domProps:{innerHTML:t._s(t.bioReplace)}},[t._v("                  ")])]),s("div",{staticClass:"tab-pane fade",attrs:{id:"comment",role:"tabpanel","aria-labelledby":"comment-tab"}},[s("div",{staticClass:"con"},t._l(t.data.comment,function(a,e){return s("div",{key:e,staticClass:"item"},[s("router-link",{staticClass:"photo",style:{backgroundImage:"url("+a.user.photoURL+")"},attrs:{to:"/"}}),s("div",{staticClass:"con"},[s("div",{staticClass:"text"},[s("router-link",{attrs:{to:"/"}},[t._v(t._s(a.user.displayName))]),s("span",[t._v(t._s(t._f("dateBefore")(a.timestamp)))]),s("pre",{staticClass:"mb-0"},[t._v(t._s(a.msg))])],1),t.userData?s("a",{staticClass:"editor",attrs:{href:"#"},on:{click:function(t){t.preventDefault()}}},[s("i",{staticClass:"fas fa-ellipsis-v"}),s("ul",[a.user.uid!==t.userData.uid?s("li",{attrs:{"data-toggle":"modal","data-target":"#reportmodal-post"},on:{click:function(a){return a.preventDefault(),t.resetReportError("item.uid")}}},[t._v("檢舉")]):t._e(),a.user.uid===t.userData.uid?s("li",[t._v("編輯")]):t._e(),a.user.uid===t.userData.uid?s("li",[t._v("刪除")]):t._e()])]):t._e()]),t.userData?s("div",{staticClass:"social",on:{click:function(e){return t.liked(a)}}},[s("span",{domProps:{innerHTML:t._s(t.comLike(a))}})]):s("div",{staticClass:"social notLogin"},[s("span",{domProps:{innerHTML:t._s(t.comLike_unLog(a))}})])],1)}),0),t.data.comment?t._e():s("p",{staticClass:"no-comment"},[t._v("尚無留言")]),t.userData?s("div",{staticClass:"write-comment"},[s("div",{staticClass:"photo",style:{backgroundImage:"url("+t.userData.photoURL+")"}}),s("div",{staticClass:"text-are"},[s("div",{staticClass:"input-group mt-1"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comments.text,expression:"comments.text"}],staticClass:"form-control",class:{"is-invalid":t.comments.error&&!t.comments.text.trim()},attrs:{placeholder:"新增公開留言",name:"comments",id:"comments"},domProps:{value:t.comments.text},on:{input:function(a){a.target.composing||t.$set(t.comments,"text",a.target.value)}}}),s("div",{staticClass:"input-group-append"},[s("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(a){return t.postComment()}}},[t._v("送出")])])]),t.comments.error&&!t.comments.text.trim()?s("p",{staticClass:"text-danger mt-1 small"},[t._v("\n                        "+t._s(t.comments.error)+"\n                      ")]):t._e()])]):s("div",{staticClass:"write-comment"},[s("div",{staticClass:"photo"},[t._v("未登入")]),s("div",{staticClass:"input-group mt-1"},[s("textarea",{staticClass:"form-control",attrs:{placeholder:"登入後即可留言",disabled:""}}),s("div",{staticClass:"input-group-append"},[s("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(a){t.dom.login=!0,t.dom.opened=!1}}},[t._v("\n                          登入")])])])])])])])])])]),s("div",{staticClass:"modal-footer py-2"},[t.userData?s("router-link",{staticClass:"btn btn-primary btn-lg px-5",attrs:{type:"button",tag:"button",to:"./"+t.data.uid+"/resume"}},[t.userData?s("span",[s("i",{staticClass:"fas fa-child"}),t._v("我要加入")]):t._e()]):s("button",{staticClass:"btn btn-primary btn-lg px-5",attrs:{type:"button",tag:"button"},on:{click:function(a){t.dom.login=!0,t.dom.opened=!1}}},[s("span",[s("i",{staticClass:"fas fa-child"}),t._v("我要加入")])])],1)])]):t._e(),s("div",{staticClass:"modal fade",attrs:{id:"reportmodal-post","data-backdrop":"false",tabindex:"-1",role:"dialog","aria-hidden":"true"}},[s("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[s("div",{staticClass:"modal-content"},[s("div",{staticClass:"modal-body"},[s("form",[s("div",{staticClass:"form-group mb-0"},[t._m(4),s("select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model",value:t.reports.type,expression:"reports.type"}],staticClass:"custom-select mb-2",class:{"is-invalid":t.errors.has("違規性質")},attrs:{name:"違規性質"},on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,function(t){return t.selected}).map(function(t){var a="_value"in t?t._value:t.value;return a});t.$set(t.reports,"type",a.target.multiple?e:e[0])}}},[s("option",{attrs:{disabled:"",selected:"",value:""}},[t._v("請選擇違規性質")]),s("option",{attrs:{value:"內容包含色情、暴力等不法言論"}},[t._v("內容包含色情、暴力等不法言論")]),s("option",{attrs:{value:"侵權、抄襲問題"}},[t._v("侵權、抄襲問題")]),s("option",{attrs:{value:"內容含廣告或內容與音樂不相關"}},[t._v("內容含廣告或內容與音樂不相關")]),s("option",{attrs:{value:"其他"}},[t._v("其他")])]),t.errors.has("違規性質")?s("p",{staticClass:"text-danger"},[t._v("\n                "+t._s(t.errors.first("違規性質"))+"\n              ")]):t._e(),s("textarea",{directives:[{name:"validate",rawName:"v-validate",value:"required|min:10",expression:"'required|min:10'"},{name:"model",rawName:"v-model",value:t.reports.msg,expression:"reports.msg"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("理由及證據")},attrs:{id:"message-text",rows:"6",name:"理由及證據",placeholder:"請說明舉報理由及證據"},domProps:{value:t.reports.msg},on:{input:function(a){a.target.composing||t.$set(t.reports,"msg",a.target.value)}}}),t.errors.has("理由及證據")?s("p",{staticClass:"text-danger"},[t._v("\n                "+t._s(t.errors.first("理由及證據"))+"\n              ")]):t._e()])])]),s("div",{staticClass:"modal-footer"},[s("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button","data-dismiss":"modal"},on:{click:function(a){return t.resetReportError("item.uid")}}},[t._v("取消")]),s("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(a){return t.report()}}},[t._v("送出")])])])])]),t.data?s("router-view",{attrs:{userData:t.userData,poster_email:t.data.poster_email,postType:"展演資訊"}}):t._e()],1)},i=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("b",[e("i",{staticClass:"fas fa-map-marker-alt"}),t._v(" 展演地區:")])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("b",[e("i",{staticClass:"fas fa-guitar"}),t._v(" 活動類型:")])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("b",[e("i",{staticClass:"far fa-calendar-alt"}),t._v(" 發布日期:")])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ul",{staticClass:"nav nav-tabs",attrs:{id:"myTab",role:"tablist"}},[e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link active",attrs:{id:"band-tab","data-toggle":"tab",href:"#band",role:"tab","aria-controls":"band","aria-selected":"true"}},[t._v("\n                    展演條件 / 活動說明:\n                  ")])]),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{id:"comment-tab","data-toggle":"tab",href:"#comment",role:"tab","aria-controls":"comment","aria-selected":"false"}},[t._v("\n                    留言板\n                  ")])])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("label",{staticClass:"col-form-label",attrs:{for:"message-text"}},[t._v("請說明舉報原因 "),e("small",[t._v("檢舉文章編號("),e("b"),t._v(")")])])}],n=e("619d"),r=(e("ac6a"),e("456d"),e("a481"),e("1157"),e("8aa5"),e("578a")),o={props:["userData"],data:function(){return{isLoading:!1,data:null,location:window.location.href,dom:{login:!1,opened:!1},comments:{text:"",error:""},reports:{id:"",type:"",msg:""}}},watch:{"comments.text":{handler:function(t){var a=document.getElementById("comments"),e=a.clientHeight;e=Math.max(a.scrollHeight,e),e>a.clientHeight&&(a.style.height=e+"px")}}},components:{Login:r["a"]},computed:{bioReplace:function(){return this.data.bio.replace(/\n/g,"<br>")}},methods:{getData:function(){var t=this;t.isLoading=!0;var a="".concat("http://127.0.0.1:3000","/getData");t.$http.post(a,{url:"/show/".concat(t.$route.params.id)}).then(function(a){t.data=a.data,t.isLoading=!1}).then(function(a){if(t.data.comment){var e=t.data.comment,s=Object.keys(e);t.data.comment=s.map(function(t){return e[t]}).reverse(),t.comments.text=""}}).then(function(){if(t.data.comment){var a=t.data.comment;a.forEach(function(a,e,s){a.liked;var i=[];if(a.liked){a.liked;for(var n in a.liked)i.push(n)}t.data.comment[e].liked=i})}})},report:function(){var t=this,a="\n        <h1>檢舉《我想表演》留言內容通知</h1>\n        <b>貼文編碼: ".concat(t.reports.id,"</b>\n        <p>舉報原因: ").concat(t.reports.type,"</p>\n        <p>理由及證據:<br> ").concat(t.reports.msg,"</p>\n        <hr>\n        <h2>舉報人資訊</h2>\n        <b>舉報人 email: ").concat(t.userData.email,"</b>\n        <p>舉報人暱稱: ").concat(t.userData.displayName,"</p>\n      ");this.$validator.validate().then(function(e){e&&t.sendReportMail(a)})},sendReportMail:function(t){var a=this,e="".concat("http://127.0.0.1:3000","/report");a.isLoading=!0,this.$http.post(e,{str:t}).then(function(t){a.isLoading=!1}).catch(function(t){console.error("錯誤",t)})},resetReportError:function(t){this.errors.clear(),this.reports.id=t,this.reports.type="",this.reports.msg=""},postComment:function(){var t=this,a="".concat("http://127.0.0.1:3000","/creatComment"),e={timestamp:Date.now(),user:{displayName:t.userData.displayName,uid:t.userData.uid,photoURL:t.userData.photoURL},liked:[],msg:t.comments.text,legal:!0};t.comments.text.trim()?(t.isLoading=!0,this.$http.post(a,{formData:e,url:"/show/".concat(t.data.uid,"/comment/")}).then(function(a){t.isLoading=!1,t.getData()}).catch(function(t){console.error("錯誤",t)})):t.comments.error="留言不得為空"},comLike:function(t){var a=this,e=a.userData.uid,s="";return s=Array.isArray(t.liked)?-1!==t.liked.indexOf(e)?'\n            <i class="fas fa-thumbs-up"></i>\n            <span>'.concat(t.liked.length,"</span>\n          "):'\n            <i class="far fa-thumbs-up"></i>\n            <span>'.concat(t.liked.length,"</span>\n          "):'\n          <i class="far fa-thumbs-up"></i>\n          <span>0</span>\n        ',s},comLike_unLog:function(t){var a="";return a=Array.isArray(t.liked)?'\n          <i class="far fa-thumbs-up"></i>\n          <span>'.concat(t.liked.length,"</span>\n        "):'\n          <i class="far fa-thumbs-up"></i>\n          <span>0</span>\n        ',a},liked:function(t){var a=this,e=a.userData.uid;a.userData&&(t.liked&&-1!==t.liked.indexOf(e)?a.sendLikeAPI(t,"unlike"):a.sendLikeAPI(t,"likes"))},sendLikeAPI:function(t,a){var e=this,s="".concat("http://127.0.0.1:3000","/liked");e.$http.post(s,{userId:e.userData.uid,method:a,url:"/show/".concat(e.data.uid,"/comment/").concat(t.uid,"/liked")}).then(function(t){e.getData()})},autogrow:function(t){var a=t.clientHeight;Object(n["a"])("adjustedHeight"),a=Math.max(t.scrollHeight,a),a>t.clientHeight&&(t.style.height=a+"px")}},created:function(){var t=this;this.getData(),t.$bus.$on("close:login",function(a){t.dom.login=a})}},l=o,c=(e("e767"),e("2877")),d=Object(c["a"])(l,s,i,!1,null,"4e173437",null);a["default"]=d.exports},"456d":function(t,a,e){var s=e("4bf8"),i=e("0d58");e("5eda")("keys",function(){return function(t){return i(s(t))}})},"4c2a":function(t,a,e){},"5eda":function(t,a,e){var s=e("5ca1"),i=e("8378"),n=e("79e5");t.exports=function(t,a){var e=(i.Object||{})[t]||Object[t],r={};r[t]=a(e),s(s.S+s.F*n(function(){e(1)}),"Object",r)}},"619d":function(t,a,e){"use strict";function s(t){throw new Error('"'+t+'" is read-only')}e.d(a,"a",function(){return s})},ac6a:function(t,a,e){for(var s=e("cadf"),i=e("0d58"),n=e("2aba"),r=e("7726"),o=e("32e9"),l=e("84f2"),c=e("2b4c"),d=c("iterator"),u=c("toStringTag"),m=l.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},v=i(p),f=0;f<v.length;f++){var h,g=v[f],b=p[g],_=r[g],C=_&&_.prototype;if(C&&(C[d]||o(C,d,m),C[u]||o(C,u,g),l[g]=m,b))for(h in s)C[h]||n(C,h,s[h],!0)}},e767:function(t,a,e){"use strict";var s=e("4c2a"),i=e.n(s);i.a}}]);
//# sourceMappingURL=chunk-1f499a4c.3486e14c.js.map