(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-632329c8"],{2174:function(t,a,e){"use strict";e.r(a);var o=function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("div",{staticClass:"container-fluid"},[o("loading",{attrs:{active:t.isLoading},on:{"update:active":function(a){t.isLoading=a}}},[o("img",{attrs:{alt:"Meason",src:e("333e"),width:"100"}})]),o("div",{staticClass:"row"},[t._m(0),o("div",{staticClass:"col-lg-9 col-md-8 right-content"},[o("div",{},[o("h3",[t._v("找夥伴 - 發佈貼文")]),o("div",{staticClass:"form"},[o("form",{on:{submit:function(t){t.preventDefault()}}},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-md-12"},[o("div",{staticClass:"form-group"},[t._m(1),o("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.title,expression:"formData.title"},{name:"validate",rawName:"v-validate",value:"required|max:30",expression:"'required|max:30'"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("title")},attrs:{type:"text",placeholder:"貼文標題 / 樂團名稱",id:"bandname",name:"title","data-vv-as":"貼文標題"},domProps:{value:t.formData.title},on:{input:function(a){a.target.composing||t.$set(t.formData,"title",a.target.value)}}}),t.errors.has("title")?o("p",{staticClass:"text-danger mt-1 small"},[t._v("\n                      "+t._s(t.errors.first("title"))+"\n                    ")]):t._e()])]),o("div",{staticClass:"col-md-6"},[t._m(2),o("br"),o("select",{directives:[{name:"model",rawName:"v-model",value:t.formData.city,expression:"formData.city"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"custom-select",class:{"is-invalid":t.errors.has("city")},attrs:{id:"city",name:"city","data-vv-as":"所在地區"},on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,function(t){return t.selected}).map(function(t){var a="_value"in t?t._value:t.value;return a});t.$set(t.formData,"city",a.target.multiple?e:e[0])}}},[o("option",{attrs:{value:"",disabled:""}},[t._v("請選擇")]),o("option",{attrs:{value:"台北市"}},[t._v("台北市")]),o("option",{attrs:{value:"新北市"}},[t._v("新北市")]),o("option",{attrs:{value:"桃園縣"}},[t._v("桃園縣")]),o("option",{attrs:{value:"台中市"}},[t._v("台中市")]),o("option",{attrs:{value:"台南市"}},[t._v("台南市")]),o("option",{attrs:{value:"高雄市"}},[t._v("高雄市")]),o("option",{attrs:{value:"基隆市"}},[t._v("基隆市")]),o("option",{attrs:{value:"新竹縣"}},[t._v("新竹縣")]),o("option",{attrs:{value:"嘉義縣"}},[t._v("嘉義縣")]),o("option",{attrs:{value:"苗栗縣"}},[t._v("苗栗縣")]),o("option",{attrs:{value:"彰化縣"}},[t._v("彰化縣")]),o("option",{attrs:{value:"南投縣"}},[t._v("南投縣")]),o("option",{attrs:{value:"雲林縣"}},[t._v("雲林縣")]),o("option",{attrs:{value:"屏東縣"}},[t._v("屏東縣")]),o("option",{attrs:{value:"宜蘭縣"}},[t._v("宜蘭縣")]),o("option",{attrs:{value:"花蓮縣"}},[t._v("花蓮縣")]),o("option",{attrs:{value:"台東縣"}},[t._v("台東縣")]),o("option",{attrs:{value:"澎湖縣"}},[t._v("澎湖縣")]),o("option",{attrs:{value:"金門縣"}},[t._v("金門縣")])]),t.errors.has("city")?o("p",{staticClass:"text-danger mt-1 small"},[t._v("\n                    "+t._s(t.errors.first("city"))+"\n                  ")]):t._e()]),o("div",{staticClass:"col-md-6"},[o("div",{staticClass:"form-group"},[t._m(3),o("button",{staticClass:"form-control needText",class:{"is-invalid":"need"===t.tempDom.errorInput},attrs:{type:"button",id:"need","data-toggle":"modal","data-target":"#partner-modal"}},[t.formData.need[0]?t._e():o("span",[t._v("選擇樂手")]),o("p",{staticClass:"texts"},t._l(t.formData.need,function(a,e){return o("span",{key:e},[t._v(t._s(a))])}),0)]),"need"===t.tempDom.errorInput?o("p",{staticClass:"text-danger mt-1 small"},[t._v("未選擇樂手")]):t._e()])]),o("div",{staticClass:"col-md-6"},[o("div",{staticClass:"form-group"},[t._m(4),o("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.type,expression:"formData.type"},{name:"validate",rawName:"v-validate",value:"required|max:25",expression:"'required|max:25'"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("type")},attrs:{type:"text",id:"type",name:"type",placeholder:"ex: 重金屬、放克","data-vv-as":"曲風"},domProps:{value:t.formData.type},on:{input:function(a){a.target.composing||t.$set(t.formData,"type",a.target.value)}}}),t.errors.has("type")?o("p",{staticClass:"text-danger mt-1 small"},[t._v("\n                      "+t._s(t.errors.first("type"))+"\n                    ")]):t._e()])]),o("div",{staticClass:"col-md-6"},[o("div",{staticClass:"form-group"},[t._m(5),o("button",{staticClass:"form-control",class:{"is-invalid":"photo"===t.tempDom.errorInput},attrs:{id:"photos","data-toggle":"modal","data-target":"#upload-img"},on:{click:function(a){t.tempDom.errorInput=null}}},[t.formData.photo?o("article",[o("div",{style:{backgroundImage:"url("+t.formData.photo+")"}}),t._v(" 樂團封面\n                      ")]):o("span",[t._v("選擇圖片")])]),"photo"===t.tempDom.errorInput?o("p",{staticClass:"text-danger mt-1 small"},[t._v("未選擇圖片")]):t._e()])]),o("div",{staticClass:"col-md-12"},[o("div",{staticClass:"form-group"},[t._m(6),o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.formData.bio,expression:"formData.bio"},{name:"validate",rawName:"v-validate",value:"required|max:200",expression:"'required|max:200'"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("bio")},attrs:{rows:"10",placeholder:"內文最多 200 字",name:"bio",id:"bio","data-vv-as":"簡介"},domProps:{value:t.formData.bio},on:{input:function(a){a.target.composing||t.$set(t.formData,"bio",a.target.value)}}})]),t.errors.has("bio")?o("p",{staticClass:"text-danger mt-1 small"},[t._v("\n                    "+t._s(t.errors.first("bio"))+"\n                  ")]):t._e()]),o("div",{staticClass:"col-md-12"},[o("div",{staticClass:"form-group mb-0"},[t._m(7),o("div",{staticClass:"radio"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.tempDom.elseMailOpened,expression:"tempDom.elseMailOpened"}],attrs:{type:"radio",value:"default",id:"elseMail-default"},domProps:{checked:t._q(t.tempDom.elseMailOpened,"default")},on:{change:function(a){return t.$set(t.tempDom,"elseMailOpened","default")}}}),o("label",{attrs:{for:"elseMail-default"}},[t._v("\n                        預設信箱\n                        "),"default"===t.tempDom.elseMailOpened&&t.userData?o("small",{staticClass:"text-secondary"},[t._v("("+t._s(t.userData.email)+")")]):t._e()])]),o("div",{staticClass:"radio d-flex align-items-center"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.tempDom.elseMailOpened,expression:"tempDom.elseMailOpened"}],attrs:{type:"radio",value:"else",id:"elseMail-else"},domProps:{checked:t._q(t.tempDom.elseMailOpened,"else")},on:{change:function(a){return t.$set(t.tempDom,"elseMailOpened","else")}}}),o("label",{staticClass:"mb-0",attrs:{for:"elseMail-else"}},[t._v("\n                        其他信箱\n                      ")]),"else"===t.tempDom.elseMailOpened?o("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.poster_email,expression:"formData.poster_email"},{name:"validate",rawName:"v-validate",value:"required|email",expression:"'required|email'"}],staticClass:"form-control ml-3 animated fadeIn",class:{"is-invalid":t.errors.has("elseMail")},attrs:{type:"email",placeholder:"請填入常用信箱以接收應徵訊息","data-vv-as":"常用信箱",name:"elseMail"},domProps:{value:t.formData.poster_email},on:{input:function(a){a.target.composing||t.$set(t.formData,"poster_email",a.target.value)}}}):t._e()]),t.errors.has("elseMail")?o("p",{staticClass:"text-danger mt-1 small"},[t._v("\n                      "+t._s(t.errors.first("elseMail"))+"\n                    ")]):t._e()])]),o("div",{staticClass:"col-lg-12 d-flex mt-3 align-items-center mb-5"},[o("button",{staticClass:"btn btn-primary",on:{click:function(a){return t.creatPost()}}},[t._v("立即發佈")]),o("small",{staticClass:"ml-3"},[t._v("應徵者訊息將透過電子郵件通知唷 :D")])])])])])])])]),o("div",{staticClass:"modal fade",attrs:{id:"partner-modal",tabindex:"-1",role:"dialog","aria-hidden":"true"}},[o("div",{staticClass:"modal-dialog modal-dialog-centered",attrs:{role:"document"}},[o("div",{staticClass:"modal-content"},[t._m(8),o("div",{staticClass:"modal-body"},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-md-12"},[o("div",{staticClass:"input-group mb-3"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.tempDom.filterInput,expression:"tempDom.filterInput"}],staticClass:"form-control",attrs:{type:"text",placeholder:"♫ Search","aria-label":"","aria-describedby":"basic-addon1"},domProps:{value:t.tempDom.filterInput},on:{input:function(a){a.target.composing||t.$set(t.tempDom,"filterInput",a.target.value)}}})])])]),o("div",{staticClass:"row",attrs:{id:"instrumentItem"}},t._l(t.tempDom.filterItem,function(a,e){return o("div",{directives:[{name:"show",rawName:"v-show",value:a,expression:"item"}],key:e,staticClass:"col-md-4 col-sm-4 col-6"},[o("div",{staticClass:"radio"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.tempDom.selectNeed[e],expression:"tempDom.selectNeed[index]"}],attrs:{type:"checkbox",name:"radio",disabled:t.formData.need.length>=5&&!t.tempDom.selectNeed[e],id:"radio"+e},domProps:{value:a,checked:Array.isArray(t.tempDom.selectNeed[e])?t._i(t.tempDom.selectNeed[e],a)>-1:t.tempDom.selectNeed[e]},on:{change:function(o){var s=t.tempDom.selectNeed[e],i=o.target,r=!!i.checked;if(Array.isArray(s)){var l=a,n=t._i(s,l);i.checked?n<0&&t.$set(t.tempDom.selectNeed,e,s.concat([l])):n>-1&&t.$set(t.tempDom.selectNeed,e,s.slice(0,n).concat(s.slice(n+1)))}else t.$set(t.tempDom.selectNeed,e,r)}}}),o("label",{attrs:{for:"radio"+e}},[t._v("\n                    "+t._s(a)+"\n                  ")])])])}),0),t.formData.need.length>=5?o("p",{staticClass:"text-primary mt-1 small"},[t._v("\n              最多只能選五項\n            ")]):t._e()]),o("div",{staticClass:"modal-footer"},[o("button",{staticClass:"btn btn-primary",attrs:{type:"button","data-dismiss":"modal"},on:{click:function(a){t.tempDom.errorInput=null}}},[t._v("選擇完成")])])])])]),o("div",{staticClass:"modal fade",attrs:{id:"upload-img",tabindex:"-1",role:"dialog","aria-hidden":"true","data-backdrop":"false","data-keyboard":"false"}},[o("div",{staticClass:"modal-dialog modal-dialog-centered modal-lg",attrs:{role:"document"}},[o("div",{staticClass:"modal-content"},[o("div",{staticClass:"modal-body"},[t._m(9),t._m(10),o("div",{staticClass:"tab-content",attrs:{id:"nav-tabContent"}},[o("div",{staticClass:"tab-pane fade show active",attrs:{id:"nav-pic",role:"tabpanel","aria-labelledby":"nav-home-tab"}},[o("div",{staticClass:"row ml-0 mt-3"},t._l(t.tempData.photo,function(a,e){return o("div",{key:e,staticClass:"col-6 col-md-4 pl-0 con"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.photo,expression:"formData.photo"}],attrs:{type:"radio",name:"img-radio",id:"img-option-"+e},domProps:{value:a,checked:t._q(t.formData.photo,a)},on:{change:function(e){return t.$set(t.formData,"photo",a)}}}),o("label",{style:{"background-image":"url("+a+")"},attrs:{for:"img-option-"+e}})])}),0)]),o("div",{staticClass:"tab-pane fade",attrs:{id:"nav-host",role:"tabpanel","aria-labelledby":"nav-profile-tab"}},[o("label",{staticClass:"files",attrs:{for:"file-input"}},[!t.tempDom.imgurl||t.errors.has("photo")?o("img",{staticClass:"select-img",attrs:{src:e("0259"),alt:"音樂封面選擇"}}):o("div",{staticClass:"img-preview"},[o("img",{attrs:{src:t.tempDom.imgurl,id:"scream"}})]),o("input",{directives:[{name:"validate",rawName:"v-validate",value:"size:5000",expression:"'size:5000'"}],attrs:{type:"file",name:"photo",id:"file-input",multiple:"true",accept:"image/*","data-vv-as":"圖片檔案"},on:{change:t.preview}}),t.errors.has("photo")?o("p",{staticClass:"text-danger mt-1 small"},[t._v("\n                    請選擇小於 5MB 的圖片\n                  ")]):t._e()])])])]),o("div",{staticClass:"modal-footer"},[o("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("取消")]),o("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(a){return t.uploadImg()}}},[t._v("\n              上傳圖片\n            ")])])])])])],1)},s=[function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("div",{staticClass:"col-lg-3 col-md-4 control"},[o("img",{staticClass:"left-menu-bg-img",attrs:{src:e("b9fd"),alt:"玩音樂"}}),o("div",{staticClass:"con"},[o("h2",[t._v("找夥伴-發布貼文")]),o("hr"),o("button",{staticClass:"btn btn-outline-light",attrs:{type:"button",onclick:"window.history.back();"}},[o("i",{staticClass:"fas fa-arrow-left"}),t._v(" 返回上頁 ")])])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("label",{attrs:{for:"bandname"}},[e("i",{staticClass:"fas fa-music"}),t._v("貼文標題"),e("b",[t._v("*")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("label",{attrs:{for:"city"}},[e("i",{staticClass:"fas fa-music"}),t._v("所在地區"),e("b",[t._v("*")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("label",{attrs:{for:"need"}},[e("i",{staticClass:"fas fa-music"}),t._v("徵求樂手"),e("b",[t._v("*")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("label",{attrs:{for:"type"}},[e("i",{staticClass:"fas fa-music"}),t._v("樂團曲風"),e("b",[t._v("*")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("label",{attrs:{for:"photos"}},[e("i",{staticClass:"fas fa-music"}),t._v("樂團封面"),e("b",[t._v("*")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("label",{attrs:{for:"bio"}},[e("i",{staticClass:"fas fa-music"}),t._v("徵才條件 / 樂團介紹"),e("b",[t._v("*")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("label",{attrs:{for:"contact"}},[e("i",{staticClass:"fas fa-music"}),t._v("通知信箱")])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-title"},[t._v("\n              選擇樂手\n            ")]),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("nav",[e("div",{staticClass:"nav nav-tabs",attrs:{id:"nav-tab",role:"tablist"}},[e("a",{staticClass:"nav-item nav-link active",attrs:{id:"nav-pic-tab","data-toggle":"tab",href:"#nav-pic",role:"tab","aria-controls":"nav-pic","aria-selected":"true"}},[t._v("現有的圖片")]),e("a",{staticClass:"nav-item nav-link",attrs:{id:"nav-host-tab","data-toggle":"tab",href:"#nav-host",role:"tab","aria-controls":"nav-host","aria-selected":"false"}},[t._v("裝置中的圖片")])])])}],i=(e("34ef"),e("4917"),e("28a5"),e("6b54"),e("c5f6"),e("ac6a"),e("8aa5")),r=e.n(i),l=e("1157"),n=e.n(l),m={name:"creatPartner",data:function(){return{isLoading:!1,userData:{},formData:{bio:"",title:"",city:"",need:[]},tempDom:{alldataDone:!1,filterInput:"",filterItem:["編曲/作詞","主唱","合唱","貝斯手","電子琴手","提琴樂手","電吉他手","木吉他手","爵士鼓手","鋼琴手","木箱鼓手","DJ","B-BOX夥伴","阿卡貝拉夥伴","長笛手","薩克斯風樂手","木管樂手","銅管樂手(法國號,小號,低音大號,長號等)","吹管類樂手(笛,蕭,嗩吶,笙)","彈拔類樂手(琵琶,箏,揚琴,中阮)","拉弦類樂手(胡)","打擊鼓手(大鼓,小軍鼓)","其他"],selectNeed:[],imgurl:null,tempImg:"",errorInput:"",elseMailOpened:"default"},tempData:{photo:["https://firebasestorage.googleapis.com/v0/b/meason-music.appspot.com/o/default_photo%2F1.jpg?alt=media&token=6e69c9cd-1c73-4932-a1e5-d11a1646baa6","https://firebasestorage.googleapis.com/v0/b/meason-music.appspot.com/o/default_photo%2F4.jpg?alt=media&token=affdc7ae-4540-46d9-927b-fff7aec4d40b","https://firebasestorage.googleapis.com/v0/b/meason-music.appspot.com/o/default_photo%2F5.jpg?alt=media&token=9700dcb4-8ee6-4758-bb93-18410344f94b","https://firebasestorage.googleapis.com/v0/b/meason-music.appspot.com/o/default_photo%2F6.jpg?alt=media&token=df5d1da3-cb40-41c1-81c3-ec2d1768a688","https://firebasestorage.googleapis.com/v0/b/meason-music.appspot.com/o/default_photo%2F7.jpg?alt=media&token=8565624a-0ccc-4c70-ae05-12c7926cae3d","https://firebasestorage.googleapis.com/v0/b/meason-music.appspot.com/o/default_photo%2F8.jpg?alt=media&token=e14031c9-44d7-4d3d-b3ec-c22d11aace09","https://firebasestorage.googleapis.com/v0/b/meason-music.appspot.com/o/default_photo%2F9.jpg?alt=media&token=2d73919b-4da4-4fc4-800e-be3a1da8beca","https://firebasestorage.googleapis.com/v0/b/meason-music.appspot.com/o/default_photo%2F10.jpg?alt=media&token=d49e932d-e3e6-45de-9f0c-1bc79d209400","https://firebasestorage.googleapis.com/v0/b/meason-music.appspot.com/o/default_photo%2F11.jpg?alt=media&token=14c4b5fa-87d6-4528-af74-d354fd7c1504","https://firebasestorage.googleapis.com/v0/b/meason-music.appspot.com/o/default_photo%2F12.jpg?alt=media&token=b25d5b6f-603f-46bb-ade0-c2624f241459","https://firebasestorage.googleapis.com/v0/b/meason-music.appspot.com/o/default_photo%2F15.jpg?alt=media&token=80f80646-ca80-44e4-8f70-ca8d2a32e54e","https://firebasestorage.googleapis.com/v0/b/meason-music.appspot.com/o/default_photo%2F16.jpg?alt=media&token=e9579979-4b8b-4e78-81bd-8ba10d8b77bd","https://firebasestorage.googleapis.com/v0/b/meason-music.appspot.com/o/default_photo%2F17.jpg?alt=media&token=476f544e-afec-4933-895c-81f370b3990a","https://firebasestorage.googleapis.com/v0/b/meason-music.appspot.com/o/default_photo%2F18.jpg?alt=media&token=86a09d8f-7120-48eb-b81a-3f2685fa2383","https://firebasestorage.googleapis.com/v0/b/meason-music.appspot.com/o/default_photo%2F13.jpg?alt=media&token=87ec4e49-c076-47c9-a2a3-b4110d171bf0","https://firebasestorage.googleapis.com/v0/b/meason-music.appspot.com/o/default_photo%2F14.jpg?alt=media&token=674e5da0-3693-4fbe-9bb9-16280c3ca17b","https://firebasestorage.googleapis.com/v0/b/meason-music.appspot.com/o/default_photo%2F2.jpg?alt=media&token=87a34eaa-1c8b-4d12-845a-e9041b787401","https://firebasestorage.googleapis.com/v0/b/meason-music.appspot.com/o/default_photo%2F3.jpg?alt=media&token=d3f1a26d-d001-4afc-a142-fa7e3e5ad62a"],options:["編曲/作詞","主唱","合唱","貝斯手","電子琴手","提琴樂手","電吉他手","木吉他手","爵士鼓手","鋼琴手","木箱鼓手","DJ","B-BOX夥伴","阿卡貝拉夥伴","長笛手","薩克斯風樂手","木管樂手","銅管樂手(法國號,小號,低音大號,長號等)","吹管類樂手(笛,蕭,嗩吶,笙)","彈拔類樂手(琵琶,箏,揚琴,中阮)","拉弦類樂手(胡)","打擊鼓手(大鼓,小軍鼓)","其他"]},errorMsg:""}},watch:{"tempDom.filterInput":{handler:function(t){var a=this;a.tempDom.filterItem=a.tempData.options.map(function(a,e,o){return-1!==a.indexOf(t)&&a})}},"tempDom.selectNeed":{handler:function(t){var a=this;a.formData.need=[],t.forEach(function(t,e){t&&a.formData.need.push(a.tempData.options[e])})}},"formData.bio":{handler:function(t){var a=document.getElementById("bio"),e=a.clientHeight;e=Math.max(a.scrollHeight,e),e>a.clientHeight&&(a.style.height=e+"px")}}},methods:{preview:function(t){var a=this,e=t.target.files[0];a.tempDom.imgurl=URL.createObjectURL(e)},cvs:function(){var t,a=this,e=400,o=document.createElement("canvas"),s=new Image,i=o.getContext("2d"),r=n()("#scream"),l=r.height(),m=r.width(),c=e*l/m;return s.src=a.tempDom.imgurl,o.width=e,o.height=c,i.clearRect(0,0,e,c),i.drawImage(s,0,0,e,c),t=o.toDataURL("image/jpeg",.9),t},uploadImg:function(){var t=this;if(t.isLoading=!0,t.formData.photo)n()("#upload-img").modal("hide"),t.isLoading=!1;else{var a=Number(new Date),e=a.toString()+t.userData.uid,o=r.a.storage().ref("partner_photo/"+e),s=t.dataURLtoFile(t.cvs(),"fileName");o.put(s).then(function(a){a.ref.getDownloadURL().then(function(a){t.formData.photo=a,n()("#upload-img").modal("hide"),t.isLoading=!1})})}},dataURLtoFile:function(t,a){var e=t.split(","),o=e[0].match(/:(.*?);/)[1],s=atob(e[1]),i=s.length,r=new Uint8Array(i);while(i--)r[i]=s.charCodeAt(i);return new File([r],a,{type:o})},getUserData:function(){var t=this,a="".concat("https://glacial-bayou-94392.herokuapp.com","/getData");r.a.auth().onAuthStateChanged(function(e){e?t.$http.post(a,{url:"users/".concat(e.uid,"/basic/")}).then(function(a){t.userData=a.data,t.userData.uid=e.uid}):t.userData=null})},creatPost:function(){var t=this;this.$validator.validate().then(function(a){a?t.formData.need[0]?t.formData.photo?(t.tempDom.alldataDone=!0,t.userData?t.sendPostAPI():(alert("會員登入狀況出現錯誤，請重新登入"),t.$router.push("/partner"))):t.tempDom.errorInput="photo":t.tempDom.errorInput="need":console.log("欄位不完整")})},sendPostAPI:function(){var t=this;t.isLoading=!0;var a="".concat("https://glacial-bayou-94392.herokuapp.com","/creatPartner"),e=new Date,o={bio:t.formData.bio,contact:t.formData.contact,date:"".concat(e.getFullYear(),"-").concat(e.getMonth()+1,"-").concat(e.getDate()),timestamp:Date.now(),display:!0,legal:!0,need:t.formData.need,picURL:t.formData.photo,poster_email:t.formData.poster_email,poster_uid:t.userData.uid,title:t.formData.title,type:t.formData.type,city:t.formData.city,uid:""};"default"===t.tempDom.elseMailOpened&&(o.poster_email=t.userData.email),this.$http.post(a,{formData:o}).then(function(a){t.isLoading=!1,t.$router.push("/partner")}).catch(function(a){console.error("寫入錯誤",a),alert("發佈失敗，請稍後再重試，或聯繫迷聲客服中心"),t.isLoading=!1})}},created:function(){var t=this;t.getUserData(),window.onbeforeunload=function(t){t.returnValue="離開後不會保存內容"}},beforeRouteLeave:function(t,a,e){if(this.tempDom.alldataDone)e();else{var o=window.confirm("確定要離開嗎？系統不會保存目前內容");o?e():e(!1)}}},c=m,d=(e("c136"),e("2877")),p=Object(d["a"])(c,o,s,!1,null,"79ad33b3",null);a["default"]=p.exports},c136:function(t,a,e){"use strict";var o=e("f024"),s=e.n(o);s.a},f024:function(t,a,e){}}]);
//# sourceMappingURL=chunk-632329c8.7ffad71d.js.map